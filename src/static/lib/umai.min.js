!function(e,l){"object"==typeof exports&&"undefined"!=typeof module?l(exports):"function"==typeof define&&define.amd?define(["exports"],l):l(e.umai={})}(this,(function(e){let l=void 0,n=[],t={},f=Array.isArray,r=e=>"string"==typeof e,i=e=>"function"==typeof e,o=e=>null!==e&&!f(e)&&"object"==typeof e,u=e=>null==e?e:e.key,s=(e,n,t,f)=>{if("dom"===n);else if(n in e&&"list"!==n&&"form"!==n&&"style"!==n){if("o"===n[0]&&"n"===n[1]){let e,n=t;t=t=>(e=n(t))instanceof Promise?e.finally(n=>(f(),e=l)):(f(),e=l)}e[n]=t}else null==t||!1===t?e.removeAttribute(n):e.setAttribute(n,"style"===n&&o(t)?(r=t,Object.entries(r).map(([e,l])=>e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())+":"+l).join(";")):t);var r},p=e=>!0!==e&&!1!==e&&e?e:{type:3,tag:""},c=(e,n)=>{let f,r=e.tag.memo,o=n?n.l:l,u=e.l;return f=o&&r&&!((e,l)=>{for(let n in e)if(e[n]!==l[n])return!0;for(let n in l)if(e[n]!==l[n])return!0})(o,u)?n.t:e.tag({...u,children:e.children},o||t),"="===f.tag?f=n.t:i(f)&&(e.type=4,f.memo=r,f={...e,type:2,tag:f}),f.key=e.key,f},y=(e,n)=>{if(2===e.type||4===e.type)return e.i=((e,l)=>y(e.t=c(e),l))(e,n);let t,f=e.l,r=3===e.type?document.createTextNode(e.tag):document.createElement(e.tag);for(t in f)s(r,t,f[t],n);if(1===e.type)for(t=0;t<e.children.length;t++)r.appendChild(y(e.children[t]=p(e.children[t]),n));return e.rm=f?i(f.dom)&&f.dom(r):l,e.i=r},d=(e,n=[])=>{if(e.children!==l)for(let l=0;l<e.children.length;l++)d(e.children[l],n);if(e.t!==l)d(e.t,n);else if(i(e.rm)){let l=e.rm(e.i);l&&i(l.then)&&(n.o=!0),n.push(l)}return n},a=(e,l)=>{let n=n=>e.removeChild(l.i),t=d(l);t.o?Promise.all(t).finally(n):n()},m=(e,l,n,t,f)=>{if(null!=n&&n.tag===t.tag&&(t.rm=n.rm),n===t);else if(null!=n&&3===n.type&&3===t.type)n.tag!==t.tag&&(l.nodeValue=t.tag);else if(null==n||n.tag!==t.tag)l=e.insertBefore(y(t=p(t),f),l),null!=n&&a(e,n);else if(4===n.type&&n.tag===t.tag)t.type=4,t.t={...n.t,l:t.l,children:t.children},m(e,l,n.t,t.t,f);else if(2===n.type&&n.tag===t.tag)t.t=c(t,n),m(e,l,n.t,t.t,f);else{let e,r,i,o,c=n.l,d=t.l,g=n.children,h=t.children,b=0,j=0,k=g.length-1,v=h.length-1;for(let e in{...c,...d})("value"===e||"selected"===e||"checked"===e?l[e]:c[e])!==d[e]&&s(l,e,d[e],f);for(;j<=v&&b<=k&&null!=(i=u(g[b]))&&i===u(h[j]);)m(l,g[b].i,g[b],h[j]=p(h[j++],g[b++]),f);for(;j<=v&&b<=k&&null!=(i=u(g[k]))&&i===u(h[v]);)m(l,g[k].i,g[k],h[v]=p(h[v--],g[k--]),f);if(b>k)for(;j<=v;)l.insertBefore(y(h[j]=p(h[j++]),f),(r=g[b])&&r.i);else if(j>v)for(;b<=k;)a(l,g[b++]);else{let n={},t={};for(let e=b;e<=k;e++)null!=(i=u(g[e]))&&(n[i]=g[e]);for(;j<=v;)i=u(r=g[b]),o=u(h[j]=p(h[j])),t[i]||null!=o&&o===u(g[b+1])?(null==i&&a(l,r),b++):null==o?(null==i&&(m(l,r&&r.i,r,h[j],f),j++),b++):(i===o?(m(l,r.i,r,h[j],f),t[o]=!0,b++):null!=(e=n[o])?(m(l,l.insertBefore(e.i,r&&r.i),e,h[j],f),t[o]=!0):m(l,r&&r.i,null,h[j],f),j++);for(;b<=k;)null==u(r=g[b++])&&a(l,r);for(let e in n)null==t[e]&&a(l,n[e])}}return t.i=l},g=(e,l)=>{if(f(e))for(let n=0;n<e.length;n++)g(e[n],l);else r(e)||"number"==typeof e?l.push({type:3,tag:e}):l.push(e)};function h(e,...l){let n,t,u,s,p={},c=[],y=l[0],d=i(e)?2:1;if(null==y&&l.shift(),l.length>0&&o(y)&&!f(y.children)&&([{key:n,...p},...l]=l),r(e)){if(p.className&&(p.class=p.className),[e,...s]=e.split("."),s=s.join(" "),o(u=p.class))for(t in u)u[t]&&(s&&(s+=" "),s+=t);r(u)&&(s+=s?u?" "+u:"":u),s&&(p.class=s)}return g(l,c),"["===e?c:{type:d,tag:e,key:n,l:p,children:c}}h.retain=e=>h("="),e.m=h,e.memo=e=>(e.memo=1)&&e,e.mount=function(e,l){e.innerHTML="<a></a>";let t={type:1,i:e=e.lastChild},f=n=>e=m(e.parentNode,e,t,t=l(),r),r=e=>requestAnimationFrame(f);return n.push(r),r()&&r},e.redraw=e=>n.map(e=>e()),e.reset=e=>n=[]}));